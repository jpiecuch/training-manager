training.service('youtube', ["$window", "$rootScope", function (e, t) {
    function n(e, t) {
        return e.indexOf(t) > -1
    }

    function r(e) {
        t.$apply(function () {
            t.$broadcast(e)
        })
    }

    function i() {
        r(c + "ready")
    }

    function o(e) {
        var t = l[e.data];
        "undefined" != typeof t && r(c + t), u.currentState = t
    }

    var a = /https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube(?:-nocookie)?\.com\S*[^\w\s-])([\w-]{11})(?=[^\w-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi, d = /t=(\d+)[ms]?(\d+)?s?/, u = {ready: !1, playerId: null, player: null, videoId: null, playerHeight: "390", playerWidth: "100%", currentState: null, setURL: function (e) {
        u.videoId = u.getIdFromURL(e)
    }, getIdFromURL: function (e) {
        var t = e.replace(a, "$1");
        if (n(t, ";")) {
            var r = t.split(";");
            if (n(r[1], "%")) {
                var i = decodeURIComponent(t.split(";")[1]);
                t = ("http://youtube.com" + i).replace(a, "$1")
            } else t = r[0]
        } else n(t, "#") && (t = t.split("#")[0]);
        return t
    }, getTimeFromURL: function (e) {
        e || (e = "");
        var t = e.match(d);
        if (!t)return 0;
        var r = t[0], i = t[1], o = t[2];
        return"undefined" != typeof o ? (o = parseInt(o, 10), i = parseInt(i, 10)) : n(r, "m") ? (i = parseInt(i, 10), o = 0) : (o = parseInt(i, 10), i = 0), o + 60 * i
    }, createPlayer: function () {
        return new YT.Player(this.playerId, {height: this.playerHeight, width: this.playerWidth, videoId: this.videoId, events: {onReady: i, onStateChange: o}})
    }, loadPlayer: function () {
        this.ready && this.playerId && this.videoId && (this.player && "function" == typeof this.player.destroy && this.player.destroy(), this.player = this.createPlayer())
    }}, l = {0: "ended", 1: "playing", 2: "paused", 3: "buffering", 5: "queued"}, c = "youtube.player.";
    return e.onYouTubeIframeAPIReady = function () {
        t.$apply(function () {
            u.ready = !0
        })
    }, u
}]);